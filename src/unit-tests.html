<!-- Works with Apache (WAMP/MAMP) from app/src sub folder, 
	 and with lite server from root -->
<!DOCTYPE html>
<html>
	<head>
		<base href="./">
   		<meta http-equiv="content-type" content="text/html;charset=utf-8">
		<title>Public Transport App Unit Tests</title>
		<!-- IE required polyfills, in this exact order -->
			<script src="../node_modules/core-js/client/shim.min.js"></script>
			<script src="../node_modules/zone.js/dist/zone.js"></script>
			<script src="../node_modules/reflect-metadata/Reflect.js"></script>
			<script src="../node_modules/systemjs/dist/system.src.js"></script>
		<!-- Other polyfills -->
			<script src="../bower_components/webcomponentsjs/webcomponents-lite.min.js"></script>
			<script src="../node_modules/whatwg-fetch/fetch.js"></script>
	    <!-- JavaScript vendor libraries -->
    	  <script src="lib/modernizr-custom.js"></script>
		  <script src="./lib/pull-to-refresh-handler.js"></script>
    	 <!-- Polymer Elements -->
			<link rel="import" href="../bower_components/iron-icons/iron-icons.html">
			<link rel="import" href="../bower_components/iron-icons/maps-icons.html">
			<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
			<link rel="import" href="../bower_components/paper-drawer-panel/paper-drawer-panel.html">
			<link rel="import" href="../bower_components/paper-header-panel/paper-header-panel.html">
			<link rel="import" href="../bower_components/paper-input/paper-input.html">
			<link rel="import" href="../bower_components/paper-toolbar/paper-toolbar.html">
			<link rel="import" href="../bower_components/paper-toast/paper-toast.html">
			<link rel="import" href="../bower_components/vaadin-date-picker/vaadin-date-picker.html">
			<link rel="import" href="../bower_components/vaadin-combo-box/vaadin-combo-box.html">
	    <!-- Jasmine -->
			<link rel="shortcut icon" type="image/png" href="../node_modules/jasmine-core/images/jasmine_favicon.png">
			<link rel="stylesheet" href="../node_modules/jasmine-core/lib/jasmine-core/jasmine.css">
			<script src="../node_modules/jasmine-core/lib/jasmine-core/jasmine.js"></script>
			<script src="../node_modules/jasmine-core/lib/jasmine-core/jasmine-html.js"></script>
			<script src="../node_modules/jasmine-core/lib/jasmine-core/boot.js"></script>
	</head>
	<body>
		<script src="systemjs.config.js"></script>
		<script>
			// import spec file(s) explicitly and wait for all imports to load...
			window.addEventListener('load', function() { // workaround to prevent multiple runs of each test 
				Promise.all([
					// initialize test suite (always required, later maybe run first in own Promise)
						System.import('main.spec'),
					
					// core models and interfaces
						System.import('core/agency.model.spec'),
						System.import('core/journey.model.spec'),
						System.import('core/latlng.model.spec'),
						System.import('core/leg.model.spec'),
						System.import('core/model.spec'),
						System.import('core/place.model.spec'),
						System.import('core/route.model.spec'),
						System.import('core/serializable.interface.spec'),
						System.import('core/stop.model.spec'),
						System.import('core/stop-time.model.spec'),
						System.import('core/trip.model.spec'),
					
					// local storage
						System.import('offline/cache.worker.class.spec'),
						System.import('offline/local-storage.class.spec'),
						System.import('offline/indexeddb-storage.class.spec'),
					
					// other utilities
						System.import('util/component-state.model.spec'),
						System.import('util/device.class.spec'),
						System.import('util/id-generator.class.spec'),
					
					// components (including component specific services)
						System.import('arrivals/arrivals.component.spec'),
						System.import('departures/departures.component.spec'),
						System.import('journeyplanner/journey-details.component.spec'),
						System.import('journeyplanner/journey-search.component.spec'),
						System.import('journeyplanner/journey.component.spec'),
					
					// other services
						// arrivals, departures and journey services are tested with their components, to save on testbed overhead
						System.import('locationsearch/location.service.spec'),
					
					// rejseplanen api models
						System.import('api/rejseplanen/core/rejseplanen-agency.model.spec'),
						System.import('api/rejseplanen/core/rejseplanen-factory.model.spec'),
						System.import('api/rejseplanen/core/rejseplanen-journey.model.spec'),
						System.import('api/rejseplanen/core/rejseplanen-leg.model.spec'),
						System.import('api/rejseplanen/core/rejseplanen-place.model.spec'),
						System.import('api/rejseplanen/core/rejseplanen-route.model.spec'),
						System.import('api/rejseplanen/core/rejseplanen-stop.model.spec'),
						System.import('api/rejseplanen/core/rejseplanen-trip.model.spec'),
											
					// rejseplanen api services
						System.import('api/rejseplanen/arrivals/rejseplanen-arrival.service.spec'),
						System.import('api/rejseplanen/departures/rejseplanen-departure.service.spec'),
						System.import('api/rejseplanen/journeyplanner/rejseplanen-journey.service.spec'),
						System.import('api/rejseplanen/locationsearch/rejseplanen-location.service.spec')
				])
					.then((result) => {
						window.onload();
					})
					.catch(console.error.bind(console));
			});
		</script>
	</body>
</html>